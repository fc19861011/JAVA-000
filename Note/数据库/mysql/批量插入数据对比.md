## 1、存储过程(有序插入)

>binlog日志没有开

### 1.1 逐条插入

插入前清空数据表，插入10000条数据共用时：1 m 37 s 851 ms

```sql
create
    definer = root@`%` procedure order_data_init()
begin
    declare i int;
    set i=0;
    while i<1000000 do
        insert into order_info(order_code, order_status,
                               create_time, payment_time, delivery_time,
                               expected_time, arrive_time, complete_time,
                               merchant_id, merchant_name, customer_id,
                               customer_name)
        values(concat('234234023423',i),'1', REPLACE(unix_timestamp(current_timestamp(3)),'.',''),
               REPLACE(unix_timestamp(current_timestamp(3)),'.',''),
               REPLACE(unix_timestamp(current_timestamp(3)),'.',''),
               REPLACE(unix_timestamp(current_timestamp(3)),'.',''),
               REPLACE(unix_timestamp(current_timestamp(3)),'.',''),
               REPLACE(unix_timestamp(current_timestamp(3)),'.',''),
               i,concat('merchant_name',i),i
               ,concat('customer_name',i)
               );
        set i=i+1;
        commit;
    end while;
end;

```

### 1.2 批量提交

```sql
create
    definer = root@`%` procedure order_data_batch_init()
begin
    declare i int;
    declare SQL_FOR_INSERT longblob;
    set i = 0;
    while i < 1000000
        do
            if i % 1000 = 0 then
                set SQL_FOR_INSERT = concat('insert into order_info(order_code, order_status,',
                                 'create_time, payment_time, delivery_time,',
                                 'expected_time, arrive_time, complete_time,',
                                 'merchant_id, merchant_name, customer_id,',
                                 'customer_name) values ');
                set SQL_FOR_INSERT = concat(SQL_FOR_INSERT,
                                 '(', concat('''','234234023423', i,''''), ',', '''1''', ',',
                                 REPLACE(unix_timestamp(current_timestamp(3)), '.', ''), ',',
                                 REPLACE(unix_timestamp(current_timestamp(3)), '.', ''), ',',
                                 REPLACE(unix_timestamp(current_timestamp(3)), '.', ''), ',',
                                 REPLACE(unix_timestamp(current_timestamp(3)), '.', ''), ',',
                                 REPLACE(unix_timestamp(current_timestamp(3)), '.', ''), ',',
                                 REPLACE(unix_timestamp(current_timestamp(3)), '.', ''), ',',
                                 concat('''',i,''''), ',', concat('''','merchant_name', i,''''), ',', concat('''',i,''''), ',',
                                 concat('''','customer_name', i,''''),
                                 ')');
            else
                set SQL_FOR_INSERT = concat(SQL_FOR_INSERT,
                                 ', (', concat('''','234234023423', i,''''), ',', '''1''', ',',
                                 REPLACE(unix_timestamp(current_timestamp(3)), '.', ''), ',',
                                 REPLACE(unix_timestamp(current_timestamp(3)), '.', ''), ',',
                                 REPLACE(unix_timestamp(current_timestamp(3)), '.', ''), ',',
                                 REPLACE(unix_timestamp(current_timestamp(3)), '.', ''), ',',
                                 REPLACE(unix_timestamp(current_timestamp(3)), '.', ''), ',',
                                 REPLACE(unix_timestamp(current_timestamp(3)), '.', ''), ',',
                                 concat('''',i,''''), ',', concat('''','merchant_name', i,''''), ',', concat('''',i,''''), ',',
                                 concat('''','customer_name', i,''''),
                                 ')');
            end if;
            if (i % 999 = 0) then
                set @sql = SQL_FOR_INSERT;
                PREPARE stmt FROM @sql; -- 预处理动态sql语句
                EXECUTE stmt; -- 执行sql语句
                deallocate prepare stmt; -- 释放prepare
            end if;
            set i = i + 1;
            commit;
        end while;
end;
```

每次提交50条，插入前清空数据表，插入10000条数据共用时： 29 s 134 ms

每次提交100条，插入前清空数据表，插入10000条数据共用时： 27 s 666 ms

每次提交500条，插入前清空数据表，插入10000条数据共用时： 29 s 133 ms

每次提交1000条 ，插入前清空数据表，插入10000条数据共用时：33 s 913 ms

每次提交2000条 ，插入前清空数据表，插入10000条数据共用时：43 s 488 ms

每次提交5000条 ，插入前清空数据表，插入10000条数据共用时：1 m 8 s 984 ms

每次提交10000条 ，插入前清空数据表，插入10000条数据共用时：1 m 50 s 854 ms

